## 3.1 概述和运输层服务
运输层协议为运行在不同主机上的进程之间提供逻辑通信（logic communication）功能。
英特网的运输层协议主要有两种：**TCP** 和 **UDP**。

### 3.1.1 运输层和网络层的关系
网络层提供了主机之间的逻辑通信，而运输层为***运行在不同主机上的进程***之间提供逻辑通信。
运输层协议只工作在端系统中。
运输层协议能够提供的服务常常受制于底层网络层协议的服务模型。
然而，及时底层协议不能再网络层提供相应的服务，运输层协议也能提供某些服务。

### 3.1.2 因特网运输层概述
英特网为应用层提供了两种截然不同的运输层协议：
1. UDP（用户数据报协议）- 它为调用它的应用程序提供了一种不可靠、无连接的服务。
2. TCP（传输控制协议）- 它为调用它的应用程序提供一种可靠的、面向连接的服务。

将主机间交付扩展到进程间交付被称为运输层的多路复用（transport-layer multiplexing）与多路分解（demiltiplexing）

TCP为应用程序提供了集中附加服务，如**可靠数据传输（reliable data transfer）**， **拥塞控制（congestion control）**



## 3.2 多路复用与多路分解
在源主机从不同的套接字中收集数据块，并为每个数据块封装上首部信息从而生成报文段，然后将报文段传递到网络层，所有这些工作称为多路复用（multiplexing）。

在接收端，运输层检查这些字段，标识出接收套接字，进而将报文段定向到该套接字。 将运输层报文中的数据交付到正确的套接字的工作称为多路分解（demultiplexing）

## 3.3 无连接运输：UDP
许多应用更适合用UDP，原因主要有以下几点：
- 关于发送什么数据以及何时发送的应用层控制更为精细。
- 无须建立连接
- 无连接状态
- 分组数据包首部开销小

使用UDP的应用是可能实现可靠数据传输的，这可通过再应用程序自身中建立可靠性机制来完成（例如，可通过增加确认与重传机制来实现）。

### 3.3.1 UDP 报文段结构
UDP报文段结构由RFC768定义。
![UDP segment structure.png](https://upload-images.jianshu.io/upload_images/3515839-7c7318203ddbd92d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 3.3.2 UDP 校验和
UDP 校验和提供差错检测功能。校验和用于确定当UDP报文段从源到达目的地移动时，其中的比特是否发生了改变（例如，由于链路中的噪声干扰或者存储在路由器中引入问题）
